<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="rustdoc">
    <meta name="description" content="API documentation for the Rust `Bus` struct in crate `bus`.">
    <meta name="keywords" content="rust, rustlang, rust-lang, Bus">

    <title>bus::Bus - Rust</title>

    <link rel="stylesheet" type="text/css" href="../rustdoc.css">
    <link rel="stylesheet" type="text/css" href="../main.css">
    

    
    
</head>
<body class="rustdoc">
    <!--[if lte IE 8]>
    <div class="warning">
        This old browser is unsupported and will most likely display funky
        things.
    </div>
    <![endif]-->

    

    <nav class="sidebar">
        
        <p class='location'><a href='index.html'>bus</a></p><script>window.sidebarCurrent = {name: 'Bus', ty: 'struct', relpath: ''};</script><script defer src="sidebar-items.js"></script>
    </nav>

    <nav class="sub">
        <form class="search-form js-only">
            <div class="search-container">
                <input class="search-input" name="search"
                       autocomplete="off"
                       placeholder="Click or press ‘S’ to search, ‘?’ for more options…"
                       type="search">
            </div>
        </form>
    </nav>

    <section id='main' class="content struct">
<h1 class='fqn'><span class='in-band'>Struct <a href='index.html'>bus</a>::<wbr><a class='struct' href=''>Bus</a></span><span class='out-of-band'><span id='render-detail'>
                   <a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">
                       [<span class='inner'>&#x2212;</span>]
                   </a>
               </span><a id='src-53' class='srclink' href='../src/bus/lib.rs.html#260-283' title='goto source code'>[src]</a></span></h1>
<pre class='rust struct'>pub struct Bus&lt;T:&nbsp;<a class='trait' href='https://doc.rust-lang.org/nightly/core/clone/trait.Clone.html' title='core::clone::Clone'>Clone</a>&gt; { /* fields omitted */ }</pre><div class='docblock'><p>Bus is the main interconnect for broadcast messages.
It can be used to send broadcast messages, or to connect additional consumers.
When the Bus is dropped, receivers will continue receiving any outstanding broadcast messages
they would have received if the bus were not dropped. After all those messages have been
received, any subsequent receive call on a receiver will return a disconnected error.</p>
</div><h2 id='methods'>Methods</h2><h3 class='impl'><span class='in-band'><code>impl&lt;T:&nbsp;<a class='trait' href='https://doc.rust-lang.org/nightly/core/clone/trait.Clone.html' title='core::clone::Clone'>Clone</a>&gt; <a class='struct' href='../bus/struct.Bus.html' title='bus::Bus'>Bus</a>&lt;T&gt;</code></span><span class='out-of-band'><div class='ghost'></div><a id='src-62' class='srclink' href='../src/bus/lib.rs.html#285-531' title='goto source code'>[src]</a></span></h3>
<div class='impl-items'><h4 id='method.new' class='method'><span id='new.v' class='invisible'><code>fn <a href='#method.new' class='fnname'>new</a>(len: <a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.usize.html'>usize</a>) -&gt; <a class='struct' href='../bus/struct.Bus.html' title='bus::Bus'>Bus</a>&lt;T&gt;</code></span></h4>
<div class='docblock'><p>Allocates a new bus.</p>

<p>The provided length should be sufficient to absorb temporary peaks in the data flow, and is
thus workflow-dependent. Bus performance degrades somewhat when the queue is full, so it is
generally better to set this high than low unless you are pressed for memory.</p>
</div><h4 id='method.try_broadcast' class='method'><span id='try_broadcast.v' class='invisible'><code>fn <a href='#method.try_broadcast' class='fnname'>try_broadcast</a>(&amp;mut self, val: T) -&gt; <a class='enum' href='https://doc.rust-lang.org/nightly/core/result/enum.Result.html' title='core::result::Result'>Result</a>&lt;<a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.tuple.html'>()</a>,&nbsp;T&gt;</code></span></h4>
<div class='docblock'><p>Attempt to broadcast the given value to all consumers, but do not wait if bus is full.</p>

<p>Attempts to broadcast a value on this bus, returning it back if it could not be sent.</p>

<p>Note that, in contrast to regular channels, a bus is <em>not</em> considered closed if there are
no consumers, and thus broadcasts will continue to succeed. Thus, a successful broadcast
occurs as long as there is room on the internal bus to store the value, or some older value
has been received by all consumers. Note that a return value of <code>Err</code> means that the data
will never be received (by any consumer), but a return value of Ok does not mean that the
data will be received by a given consumer. It is possible for a receiver to hang up
immediately after this function returns Ok.</p>

<p>This method will never block the current thread.</p>

<pre class='rust rust-example-rendered'>
<span class='kw'>use</span> <span class='ident'>bus</span>::<span class='ident'>Bus</span>;
<span class='kw'>let</span> <span class='kw-2'>mut</span> <span class='ident'>tx</span> <span class='op'>=</span> <span class='ident'>Bus</span>::<span class='ident'>new</span>(<span class='number'>1</span>);
<span class='kw'>let</span> <span class='kw-2'>mut</span> <span class='ident'>rx</span> <span class='op'>=</span> <span class='ident'>tx</span>.<span class='ident'>add_rx</span>();
<span class='macro'>assert_eq</span><span class='macro'>!</span>(<span class='ident'>tx</span>.<span class='ident'>try_broadcast</span>(<span class='string'>&quot;Hello&quot;</span>), <span class='prelude-val'>Ok</span>(()));
<span class='macro'>assert_eq</span><span class='macro'>!</span>(<span class='ident'>tx</span>.<span class='ident'>try_broadcast</span>(<span class='string'>&quot;world&quot;</span>), <span class='prelude-val'>Err</span>(<span class='string'>&quot;world&quot;</span>));<a class='test-arrow' target='_blank' href=''>Run</a></pre>
</div><h4 id='method.broadcast' class='method'><span id='broadcast.v' class='invisible'><code>fn <a href='#method.broadcast' class='fnname'>broadcast</a>(&amp;mut self, val: T)</code></span></h4>
<div class='docblock'><p>Broadcasts a value on the bus to all consumers.</p>

<p>This function will block until space in the internal buffer becomes available.</p>

<p>Note that a successful send does not guarantee that the receiver will ever see the data if
there is a buffer on this channel. Items may be enqueued in the internal buffer for the
receiver to receive at a later time. Furthermore, in contrast to regular channels, a bus is
<em>not</em> considered closed if there are no consumers, and thus broadcasts will continue to
succeed.</p>
</div><h4 id='method.add_rx' class='method'><span id='add_rx.v' class='invisible'><code>fn <a href='#method.add_rx' class='fnname'>add_rx</a>(&amp;mut self) -&gt; <a class='struct' href='../bus/struct.BusReader.html' title='bus::BusReader'>BusReader</a>&lt;T&gt;</code></span></h4>
<div class='docblock'><p>Add a new consumer to this bus.</p>

<p>The new consumer will receive all <em>future</em> broadcasts on this bus.</p>

<h1 id='examples' class='section-header'><a href='#examples'>Examples</a></h1>
<pre class='rust rust-example-rendered'>
<span class='kw'>use</span> <span class='ident'>bus</span>::<span class='ident'>Bus</span>;
<span class='kw'>use</span> <span class='ident'>std</span>::<span class='ident'>sync</span>::<span class='ident'>mpsc</span>::<span class='ident'>TryRecvError</span>;

<span class='kw'>let</span> <span class='kw-2'>mut</span> <span class='ident'>bus</span> <span class='op'>=</span> <span class='ident'>Bus</span>::<span class='ident'>new</span>(<span class='number'>10</span>);
<span class='kw'>let</span> <span class='kw-2'>mut</span> <span class='ident'>rx1</span> <span class='op'>=</span> <span class='ident'>bus</span>.<span class='ident'>add_rx</span>();

<span class='ident'>bus</span>.<span class='ident'>broadcast</span>(<span class='string'>&quot;Hello&quot;</span>);

<span class='comment'>// consumer present during broadcast sees update</span>
<span class='macro'>assert_eq</span><span class='macro'>!</span>(<span class='ident'>rx1</span>.<span class='ident'>recv</span>(), <span class='prelude-val'>Ok</span>(<span class='string'>&quot;Hello&quot;</span>));

<span class='comment'>// new consumer does *not* see broadcast</span>
<span class='kw'>let</span> <span class='kw-2'>mut</span> <span class='ident'>rx2</span> <span class='op'>=</span> <span class='ident'>bus</span>.<span class='ident'>add_rx</span>();
<span class='macro'>assert_eq</span><span class='macro'>!</span>(<span class='ident'>rx2</span>.<span class='ident'>try_recv</span>(), <span class='prelude-val'>Err</span>(<span class='ident'>TryRecvError</span>::<span class='ident'>Empty</span>));

<span class='comment'>// both consumers see new broadcast</span>
<span class='ident'>bus</span>.<span class='ident'>broadcast</span>(<span class='string'>&quot;world&quot;</span>);
<span class='macro'>assert_eq</span><span class='macro'>!</span>(<span class='ident'>rx1</span>.<span class='ident'>recv</span>(), <span class='prelude-val'>Ok</span>(<span class='string'>&quot;world&quot;</span>));
<span class='macro'>assert_eq</span><span class='macro'>!</span>(<span class='ident'>rx2</span>.<span class='ident'>recv</span>(), <span class='prelude-val'>Ok</span>(<span class='string'>&quot;world&quot;</span>));<a class='test-arrow' target='_blank' href=''>Run</a></pre>
</div></div><h2 id='implementations'>Trait Implementations</h2><h3 class='impl'><span class='in-band'><code>impl&lt;T:&nbsp;<a class='trait' href='https://doc.rust-lang.org/nightly/core/clone/trait.Clone.html' title='core::clone::Clone'>Clone</a>&gt; <a class='trait' href='https://doc.rust-lang.org/nightly/core/ops/trait.Drop.html' title='core::ops::Drop'>Drop</a> for <a class='struct' href='../bus/struct.Bus.html' title='bus::Bus'>Bus</a>&lt;T&gt;</code></span><span class='out-of-band'><div class='ghost'></div><a id='src-104' class='srclink' href='../src/bus/lib.rs.html#533-541' title='goto source code'>[src]</a></span></h3>
<div class='impl-items'><h4 id='method.drop' class='method'><span id='drop.v' class='invisible'><code>fn <a href='https://doc.rust-lang.org/nightly/core/ops/trait.Drop.html#tymethod.drop' class='fnname'>drop</a>(&amp;mut self)</code></span></h4>
<div class='docblock'><p>A method called when the value goes out of scope. <a href="https://doc.rust-lang.org/nightly/core/ops/trait.Drop.html#tymethod.drop">Read more</a></p>
</div></div></section>
    <section id='search' class="content hidden"></section>

    <section class="footer"></section>

    <aside id="help" class="hidden">
        <div>
            <h1 class="hidden">Help</h1>

            <div class="shortcuts">
                <h2>Keyboard Shortcuts</h2>

                <dl>
                    <dt>?</dt>
                    <dd>Show this help dialog</dd>
                    <dt>S</dt>
                    <dd>Focus the search field</dd>
                    <dt>&larrb;</dt>
                    <dd>Move up in search results</dd>
                    <dt>&rarrb;</dt>
                    <dd>Move down in search results</dd>
                    <dt>&#9166;</dt>
                    <dd>Go to active search result</dd>
                    <dt>+</dt>
                    <dd>Collapse/expand all sections</dd>
                </dl>
            </div>

            <div class="infos">
                <h2>Search Tricks</h2>

                <p>
                    Prefix searches with a type followed by a colon (e.g.
                    <code>fn:</code>) to restrict the search to a given type.
                </p>

                <p>
                    Accepted types are: <code>fn</code>, <code>mod</code>,
                    <code>struct</code>, <code>enum</code>,
                    <code>trait</code>, <code>type</code>, <code>macro</code>,
                    and <code>const</code>.
                </p>

                <p>
                    Search functions by type signature (e.g.
                    <code>vec -> usize</code> or <code>* -> vec</code>)
                </p>
            </div>
        </div>
    </aside>

    

    <script>
        window.rootPath = "../";
        window.currentCrate = "bus";
        window.playgroundUrl = "";
    </script>
    <script src="../jquery.js"></script>
    <script src="../main.js"></script>
    
    <script defer src="../search-index.js"></script>
</body>
</html>