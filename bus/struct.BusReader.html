<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="rustdoc">
    <meta name="description" content="API documentation for the Rust `BusReader` struct in crate `bus`.">
    <meta name="keywords" content="rust, rustlang, rust-lang, BusReader">

    <title>bus::BusReader - Rust</title>

    <link rel="stylesheet" type="text/css" href="../rustdoc.css">
    <link rel="stylesheet" type="text/css" href="../main.css">
    

    
    
</head>
<body class="rustdoc">
    <!--[if lte IE 8]>
    <div class="warning">
        This old browser is unsupported and will most likely display funky
        things.
    </div>
    <![endif]-->

    

    <nav class="sidebar">
        
        <p class='location'><a href='index.html'>bus</a></p><script>window.sidebarCurrent = {name: 'BusReader', ty: 'struct', relpath: ''};</script><script defer src="sidebar-items.js"></script>
    </nav>

    <nav class="sub">
        <form class="search-form js-only">
            <div class="search-container">
                <input class="search-input" name="search"
                       autocomplete="off"
                       placeholder="Click or press ‘S’ to search, ‘?’ for more options…"
                       type="search">
            </div>
        </form>
    </nav>

    <section id='main' class="content struct">
<h1 class='fqn'><span class='in-band'>Struct <a href='index.html'>bus</a>::<wbr><a class='struct' href=''>BusReader</a></span><span class='out-of-band'><span id='render-detail'>
                   <a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">
                       [<span class='inner'>&#x2212;</span>]
                   </a>
               </span><a id='src-108' class='srclink' href='../src/bus/lib.rs.html#567-573' title='goto source code'>[src]</a></span></h1>
<pre class='rust struct'>pub struct BusReader&lt;T:&nbsp;<a class='trait' href='https://doc.rust-lang.org/nightly/core/clone/trait.Clone.html' title='core::clone::Clone'>Clone</a>&gt; { /* fields omitted */ }</pre><div class='docblock'><p>A BusReader is a single consumer of Bus broadcasts.
It will see every new value that is passed to <code>.broadcast()</code> (or successful calls to
<code>.try_broadcast()</code>) on the Bus that it was created from.</p>

<p>Dropping a BusReader is perfectly safe, and will unblock the writer if it was waiting for that
read to see a particular update.</p>

<pre class='rust rust-example-rendered'>
<span class='kw'>use</span> <span class='ident'>bus</span>::<span class='ident'>Bus</span>;
<span class='kw'>let</span> <span class='kw-2'>mut</span> <span class='ident'>tx</span> <span class='op'>=</span> <span class='ident'>Bus</span>::<span class='ident'>new</span>(<span class='number'>1</span>);
<span class='kw'>let</span> <span class='kw-2'>mut</span> <span class='ident'>r1</span> <span class='op'>=</span> <span class='ident'>tx</span>.<span class='ident'>add_rx</span>();
<span class='kw'>let</span> <span class='ident'>r2</span> <span class='op'>=</span> <span class='ident'>tx</span>.<span class='ident'>add_rx</span>();
<span class='macro'>assert_eq</span><span class='macro'>!</span>(<span class='ident'>tx</span>.<span class='ident'>try_broadcast</span>(<span class='bool-val'>true</span>), <span class='prelude-val'>Ok</span>(()));
<span class='macro'>assert_eq</span><span class='macro'>!</span>(<span class='ident'>r1</span>.<span class='ident'>recv</span>(), <span class='prelude-val'>Ok</span>(<span class='bool-val'>true</span>));

<span class='comment'>// the bus does not have room for another broadcast</span>
<span class='comment'>// since it knows r2 has not yet read the first broadcast</span>
<span class='macro'>assert_eq</span><span class='macro'>!</span>(<span class='ident'>tx</span>.<span class='ident'>try_broadcast</span>(<span class='bool-val'>true</span>), <span class='prelude-val'>Err</span>(<span class='bool-val'>true</span>));

<span class='comment'>// dropping r2 tells the producer that there is a free slot</span>
<span class='comment'>// (i.e., it has been read by everyone)</span>
<span class='ident'>drop</span>(<span class='ident'>r2</span>);
<span class='macro'>assert_eq</span><span class='macro'>!</span>(<span class='ident'>tx</span>.<span class='ident'>try_broadcast</span>(<span class='bool-val'>true</span>), <span class='prelude-val'>Ok</span>(()));<a class='test-arrow' target='_blank' href=''>Run</a></pre>
</div><h2 id='methods'>Methods</h2><h3 class='impl'><span class='in-band'><code>impl&lt;T:&nbsp;<a class='trait' href='https://doc.rust-lang.org/nightly/core/clone/trait.Clone.html' title='core::clone::Clone'>Clone</a>&gt; <a class='struct' href='../bus/struct.BusReader.html' title='bus::BusReader'>BusReader</a>&lt;T&gt;</code></span><span class='out-of-band'><div class='ghost'></div><a id='src-115' class='srclink' href='../src/bus/lib.rs.html#575-705' title='goto source code'>[src]</a></span></h3>
<div class='impl-items'><h4 id='method.try_recv' class='method'><span id='try_recv.v' class='invisible'><code>fn <a href='#method.try_recv' class='fnname'>try_recv</a>(&amp;mut self) -&gt; <a class='enum' href='https://doc.rust-lang.org/nightly/core/result/enum.Result.html' title='core::result::Result'>Result</a>&lt;T,&nbsp;<a class='enum' href='https://doc.rust-lang.org/nightly/std/sync/mpsc/enum.TryRecvError.html' title='std::sync::mpsc::TryRecvError'>TryRecvError</a>&gt;</code></span></h4>
<div class='docblock'><p>Attempts to return a pending broadcast on this receiver without blocking.</p>

<p>This method will never block the caller in order to wait for data to become available.
Instead, this will always return immediately with a possible option of pending data on the
channel.</p>

<p>If the corresponding bus has been dropped, and all broadcasts have been received, this
method will return with a disconnected error.</p>

<p>This mehtod is useful for a flavor of &quot;optimistic check&quot; before deciding to block on a
receiver.</p>

<pre class='rust rust-example-rendered'>
<span class='kw'>use</span> <span class='ident'>bus</span>::<span class='ident'>Bus</span>;
<span class='kw'>use</span> <span class='ident'>std</span>::<span class='ident'>thread</span>;

<span class='kw'>let</span> <span class='kw-2'>mut</span> <span class='ident'>tx</span> <span class='op'>=</span> <span class='ident'>Bus</span>::<span class='ident'>new</span>(<span class='number'>10</span>);
<span class='kw'>let</span> <span class='kw-2'>mut</span> <span class='ident'>rx</span> <span class='op'>=</span> <span class='ident'>tx</span>.<span class='ident'>add_rx</span>();

<span class='comment'>// spawn a thread that will broadcast at some point</span>
<span class='kw'>let</span> <span class='ident'>j</span> <span class='op'>=</span> <span class='ident'>thread</span>::<span class='ident'>spawn</span>(<span class='kw'>move</span> <span class='op'>||</span> {
    <span class='ident'>tx</span>.<span class='ident'>broadcast</span>(<span class='bool-val'>true</span>);
});

<span class='kw'>loop</span> {
    <span class='kw'>match</span> <span class='ident'>rx</span>.<span class='ident'>try_recv</span>() {
        <span class='prelude-val'>Ok</span>(<span class='ident'>val</span>) <span class='op'>=&gt;</span> {
            <span class='macro'>assert_eq</span><span class='macro'>!</span>(<span class='ident'>val</span>, <span class='bool-val'>true</span>);
            <span class='kw'>break</span>;
        }
        <span class='prelude-val'>Err</span>(..) <span class='op'>=&gt;</span> {
            <span class='comment'>// maybe we can do other useful work here</span>
            <span class='comment'>// or we can just busy-loop</span>
            <span class='ident'>thread</span>::<span class='ident'>yield_now</span>()
        },
    }
}

<span class='ident'>j</span>.<span class='ident'>join</span>().<span class='ident'>unwrap</span>();<a class='test-arrow' target='_blank' href=''>Run</a></pre>
</div><h4 id='method.recv' class='method'><span id='recv.v' class='invisible'><code>fn <a href='#method.recv' class='fnname'>recv</a>(&amp;mut self) -&gt; <a class='enum' href='https://doc.rust-lang.org/nightly/core/result/enum.Result.html' title='core::result::Result'>Result</a>&lt;T,&nbsp;<a class='struct' href='https://doc.rust-lang.org/nightly/std/sync/mpsc/struct.RecvError.html' title='std::sync::mpsc::RecvError'>RecvError</a>&gt;</code></span></h4>
<div class='docblock'><p>Read another broadcast message from the bus, and block if none are available.</p>

<p>This function will always block the current thread if there is no data available and it&#39;s
possible for more broadcasts to be sent. Once a broadcast is sent on the corresponding Bus,
then this receiver will wake up and return that message.</p>

<p>If the corresponding <code>Bus</code> has been dropped, or it is dropped while this call is blocking,
this call will wake up and return Err to indicate that no more messages can ever be
received on this channel. However, since channels are buffered, messages sent before the
disconnect will still be properly received.</p>
</div><h4 id='method.iter' class='method'><span id='iter.v' class='invisible'><code>fn <a href='#method.iter' class='fnname'>iter</a>&lt;'a&gt;(&amp;'a mut self) -&gt; <a class='struct' href='../bus/struct.BusIter.html' title='bus::BusIter'>BusIter</a>&lt;'a,&nbsp;T&gt;</code></span></h4>
<div class='docblock'><p>Returns an iterator that will block waiting for broadcasts.
It will return None when the bus has been closed (i.e., the <code>Bus</code> has been dropped).</p>
</div></div><h2 id='implementations'>Trait Implementations</h2><h3 class='impl'><span class='in-band'><code>impl&lt;T:&nbsp;<a class='trait' href='https://doc.rust-lang.org/nightly/core/clone/trait.Clone.html' title='core::clone::Clone'>Clone</a>&gt; <a class='trait' href='https://doc.rust-lang.org/nightly/core/ops/trait.Drop.html' title='core::ops::Drop'>Drop</a> for <a class='struct' href='../bus/struct.BusReader.html' title='bus::BusReader'>BusReader</a>&lt;T&gt;</code></span><span class='out-of-band'><div class='ghost'></div><a id='src-138' class='srclink' href='../src/bus/lib.rs.html#707-714' title='goto source code'>[src]</a></span></h3>
<div class='impl-items'><h4 id='method.drop' class='method'><span id='drop.v' class='invisible'><code>fn <a href='https://doc.rust-lang.org/nightly/core/ops/trait.Drop.html#tymethod.drop' class='fnname'>drop</a>(&amp;mut self)</code></span></h4>
<div class='docblock'><p>A method called when the value goes out of scope. <a href="https://doc.rust-lang.org/nightly/core/ops/trait.Drop.html#tymethod.drop">Read more</a></p>
</div></div><h3 class='impl'><span class='in-band'><code>impl&lt;'a,&nbsp;T:&nbsp;<a class='trait' href='https://doc.rust-lang.org/nightly/core/clone/trait.Clone.html' title='core::clone::Clone'>Clone</a>&gt; <a class='trait' href='https://doc.rust-lang.org/nightly/core/iter/traits/trait.IntoIterator.html' title='core::iter::traits::IntoIterator'>IntoIterator</a> for &amp;'a mut <a class='struct' href='../bus/struct.BusReader.html' title='bus::BusReader'>BusReader</a>&lt;T&gt;</code></span><span class='out-of-band'><div class='ghost'></div><a id='src-151' class='srclink' href='../src/bus/lib.rs.html#726-732' title='goto source code'>[src]</a></span></h3>
<div class='impl-items'><h4 id='associatedtype.Item' class='type'><span id='Item.t' class='invisible'><code>type <a href='https://doc.rust-lang.org/nightly/core/iter/traits/trait.IntoIterator.html#associatedtype.Item' class='type'>Item</a> = T</code></span></h4>
<div class='docblock'><p>The type of the elements being iterated over.</p>
</div><h4 id='associatedtype.IntoIter' class='type'><span id='IntoIter.t' class='invisible'><code>type <a href='https://doc.rust-lang.org/nightly/core/iter/traits/trait.IntoIterator.html#associatedtype.IntoIter' class='type'>IntoIter</a> = <a class='struct' href='../bus/struct.BusIter.html' title='bus::BusIter'>BusIter</a>&lt;'a,&nbsp;T&gt;</code></span></h4>
<div class='docblock'><p>Which kind of iterator are we turning this into?</p>
</div><h4 id='method.into_iter' class='method'><span id='into_iter.v' class='invisible'><code>fn <a href='https://doc.rust-lang.org/nightly/core/iter/traits/trait.IntoIterator.html#tymethod.into_iter' class='fnname'>into_iter</a>(self) -&gt; <a class='struct' href='../bus/struct.BusIter.html' title='bus::BusIter'>BusIter</a>&lt;'a,&nbsp;T&gt;</code></span></h4>
<div class='docblock'><p>Creates an iterator from a value. <a href="https://doc.rust-lang.org/nightly/core/iter/traits/trait.IntoIterator.html#tymethod.into_iter">Read more</a></p>
</div></div><h3 class='impl'><span class='in-band'><code>impl&lt;T:&nbsp;<a class='trait' href='https://doc.rust-lang.org/nightly/core/clone/trait.Clone.html' title='core::clone::Clone'>Clone</a>&gt; <a class='trait' href='https://doc.rust-lang.org/nightly/core/iter/traits/trait.IntoIterator.html' title='core::iter::traits::IntoIterator'>IntoIterator</a> for <a class='struct' href='../bus/struct.BusReader.html' title='bus::BusReader'>BusReader</a>&lt;T&gt;</code></span><span class='out-of-band'><div class='ghost'></div><a id='src-158' class='srclink' href='../src/bus/lib.rs.html#734-740' title='goto source code'>[src]</a></span></h3>
<div class='impl-items'><h4 id='associatedtype.Item-1' class='type'><span id='Item.t-1' class='invisible'><code>type <a href='https://doc.rust-lang.org/nightly/core/iter/traits/trait.IntoIterator.html#associatedtype.Item' class='type'>Item</a> = T</code></span></h4>
<div class='docblock'><p>The type of the elements being iterated over.</p>
</div><h4 id='associatedtype.IntoIter-1' class='type'><span id='IntoIter.t-1' class='invisible'><code>type <a href='https://doc.rust-lang.org/nightly/core/iter/traits/trait.IntoIterator.html#associatedtype.IntoIter' class='type'>IntoIter</a> = <a class='struct' href='../bus/struct.BusIntoIter.html' title='bus::BusIntoIter'>BusIntoIter</a>&lt;T&gt;</code></span></h4>
<div class='docblock'><p>Which kind of iterator are we turning this into?</p>
</div><h4 id='method.into_iter-1' class='method'><span id='into_iter.v-1' class='invisible'><code>fn <a href='https://doc.rust-lang.org/nightly/core/iter/traits/trait.IntoIterator.html#tymethod.into_iter' class='fnname'>into_iter</a>(self) -&gt; <a class='struct' href='../bus/struct.BusIntoIter.html' title='bus::BusIntoIter'>BusIntoIter</a>&lt;T&gt;</code></span></h4>
<div class='docblock'><p>Creates an iterator from a value. <a href="https://doc.rust-lang.org/nightly/core/iter/traits/trait.IntoIterator.html#tymethod.into_iter">Read more</a></p>
</div></div></section>
    <section id='search' class="content hidden"></section>

    <section class="footer"></section>

    <aside id="help" class="hidden">
        <div>
            <h1 class="hidden">Help</h1>

            <div class="shortcuts">
                <h2>Keyboard Shortcuts</h2>

                <dl>
                    <dt>?</dt>
                    <dd>Show this help dialog</dd>
                    <dt>S</dt>
                    <dd>Focus the search field</dd>
                    <dt>&larrb;</dt>
                    <dd>Move up in search results</dd>
                    <dt>&rarrb;</dt>
                    <dd>Move down in search results</dd>
                    <dt>&#9166;</dt>
                    <dd>Go to active search result</dd>
                    <dt>+</dt>
                    <dd>Collapse/expand all sections</dd>
                </dl>
            </div>

            <div class="infos">
                <h2>Search Tricks</h2>

                <p>
                    Prefix searches with a type followed by a colon (e.g.
                    <code>fn:</code>) to restrict the search to a given type.
                </p>

                <p>
                    Accepted types are: <code>fn</code>, <code>mod</code>,
                    <code>struct</code>, <code>enum</code>,
                    <code>trait</code>, <code>type</code>, <code>macro</code>,
                    and <code>const</code>.
                </p>

                <p>
                    Search functions by type signature (e.g.
                    <code>vec -> usize</code> or <code>* -> vec</code>)
                </p>
            </div>
        </div>
    </aside>

    

    <script>
        window.rootPath = "../";
        window.currentCrate = "bus";
        window.playgroundUrl = "";
    </script>
    <script src="../jquery.js"></script>
    <script src="../main.js"></script>
    
    <script defer src="../search-index.js"></script>
</body>
</html>